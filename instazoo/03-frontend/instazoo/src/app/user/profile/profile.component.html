<div class="profile-content" *ngIf="isUserDataLoaded; else emptyProfileBlock">
  <div>
    <div *ngIf="this.user.isLoginUserPage" style="text-align: right">
      <button mat-flat-button color="primary" (click)="openUserEditDialog()">Edit Info</button>
    </div>

    <div style="padding-top: 2rem" class="row">
      <div class="col">
        <div>
          <span *ngIf="!this.user.profileImage">
            <img  class="profile-image" [src]="previewImgURL || 'https://www.missingdogsuk.co.uk/wp-content/plugins/wp-job-manager-resumes/assets/images/candidate.png'" alt="user image">
          </span>
          <span *ngIf="this.user.profileImage">
            <img  class="profile-image" [src]="previewImgURL || (this.user.profileImage.imageBytes |setterImagePipe) || 'https://www.missingdogsuk.co.uk/wp-content/plugins/wp-job-manager-resumes/assets/images/candidate.png'" alt="user image">
          </span>
        </div>
        <div *ngIf="this.user.isLoginUserPage" style="margin: 1rem">
          <input type="file"
                 style="display: none"
                 #fileInput
                 (change)="onFileSelected($event)">
          <button mat-button (click)="fileInput.click()">Pick File</button>
          <button mat-button *ngIf="selectedFile" (click)="onUpload()">Upload</button>
        </div>
      </div>

      <div class="col" style="text-align: left">

        <h2>{{user.username}}</h2>

        <h3 style="font-style: italic">{{user.firstname}} {{user.lastname}}</h3>
        <p>{{user.bio}}</p>
      </div>

    </div>

    <mat-divider style="margin: 1rem 0"></mat-divider>

    <div *ngIf="this.user.isLoginUserPage">
      <mat-expansion-panel [expanded]="createPostPanelOpenState">
        <mat-expansion-panel-header (click)="togglePanel()">
          <mat-panel-title>
            <p>Create post</p>
          </mat-panel-title>
        </mat-expansion-panel-header>
        <app-add-post (addPostRequest)="addNewPost($event)"></app-add-post>
      </mat-expansion-panel>
    </div>

    <app-user-posts [events]="eventsSubject.asObservable()" [currentUserPageId]="this.user.id"></app-user-posts>
  </div>
</div>

<ng-template #emptyProfileBlock>
  <div class="alert alert-warning empty-profile-block" role="alert">
    Profile not loaded yet...
  </div>
</ng-template>
